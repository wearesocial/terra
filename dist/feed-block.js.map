{"version":3,"sources":["feed-block.js"],"names":["initializeBlock","waitForElement","selector","callback","timeout","setInterval","element","document","querySelector","clearInterval","doSettingsChanges","taxonomies","tax","value","taxTerms","querySelectorAll","updateTerms","addEventListener","e","currentTarget","terms","forEach","term","label","getAttribute","style","display","window","acf","addAction","block","jQuery","settingsElement"],"mappings":";CAAA,WACQA,IAcAC,EAAiB,SAACC,EAAUC,GAC1BC,IAAAA,EAAUC,YAAY,WACpBC,IAAAA,EAAUC,SAASC,cAAcN,GACnCI,IACFG,cAAcL,GACdD,EAASG,KAEV,MAGCI,EAAoB,SAAAJ,GACpBA,GAAY,OAAZA,EAAAA,CAIEK,IAAAA,EAAaL,EAAQE,cAAc,4CACrCI,EAAMD,EAAWE,MACfC,EAAWR,EAAQS,iBAAiB,sDAC1CC,EAAYJ,EAAKE,GACjBH,EAAWM,iBAAiB,SAAU,SAAAC,GACpCN,EAAMM,EAAEC,cAAcN,MACtBG,EAAYJ,EAAKE,OAIfE,EAAc,SAACJ,EAAKQ,GACnBR,GAAQQ,EAAM,IAInBA,EAAMC,QAAQ,SAAAC,GACNC,IAAAA,EAAQD,EAAKE,aAAa,SAE9BF,EAAKG,MAAMC,QADTd,IAAQW,EACW,QAEA,UAKvBI,OAAOC,KACTD,OAAOC,IAAIC,UAAU,uCAvDC,SAAAC,GAChBxB,IAAAA,EAAUwB,aAAiBC,OAASD,EAAM,GAAKA,EACrC,OAAZxB,GAIJA,EAAQW,iBAAiB,QAAS,SAAAC,GAChCjB,EAAe,oBAAqB,SAAS+B,GAC3CtB,EAAkBsB,SAT1B","file":"feed-block.js","sourceRoot":"../src","sourcesContent":["(() => {\n  const initializeBlock = block => {\n    const element = block instanceof jQuery ? block[0] : block;\n    if (element === null) {\n      return;\n    }\n\n    element.addEventListener('click', e => {\n      waitForElement('.acf-block-fields', function(settingsElement){\n        doSettingsChanges(settingsElement);\n      });\n    });\n\n  };\n\n  const waitForElement = (selector, callback) => {\n    const timeout = setInterval(() => {\n      const element = document.querySelector(selector);\n      if (element) {\n        clearInterval(timeout);\n        callback(element);\n      }\n    }, 500);\n  };\n\n  const doSettingsChanges = element => {\n    if (element === null) {\n      return;\n    }\n\n    const taxonomies = element.querySelector('div[data-name=\"terra_taxonomies\"] select');\n    let tax = taxonomies.value;\n    const taxTerms = element.querySelectorAll('div[data-name=\"terra_term_select\"] select optgroup');\n    updateTerms(tax, taxTerms);\n    taxonomies.addEventListener('change', e => {\n      tax = e.currentTarget.value;\n      updateTerms(tax, taxTerms);\n    });\n  };\n\n  const updateTerms = (tax, terms) => {\n    if (!tax || !terms[0]) {\n      return;\n    }\n\n    terms.forEach(term => {\n      const label = term.getAttribute('label');\n      if (tax === label) {\n        term.style.display = 'block';\n      } else {\n        term.style.display = 'none';\n      }\n    });\n  };\n\n  if (window.acf) {\n    window.acf.addAction('render_block_preview/type=terra-feed', initializeBlock);\n  }\n})();\n"]}